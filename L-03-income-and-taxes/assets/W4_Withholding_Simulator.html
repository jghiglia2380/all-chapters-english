<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W-4 Withholding Simulator | PFL Academy</title>
    <!--
    STATE VARIABLES USED IN THIS FILE:
    - STATE_NAME
    - STATE_CODE
    - STATE_INCOME_TAX_RATE

    UPDATE FREQUENCY:
    - Annual: STATE_INCOME_TAX_RATE
    

    PURPOSE: Practice completing W-4 form and seeing impact on take-home pay
    USE: Day 2 activity (10-12 minutes)
    -->
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --text: #1f2937;
            --text-light: #6b7280;
            --background: #ffffff;
            --surface: #f9fafb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--surface);
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--background);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .state-badge {
            display: inline-block;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .main-content {
            padding: 30px;
        }

        .scenario-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .scenario-button {
            padding: 20px;
            background-color: var(--surface);
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .scenario-button:hover {
            border-color: var(--primary);
            background-color: white;
        }

        .scenario-button.active {
            border-color: var(--primary);
            background-color: #ede9fe;
        }

        .scenario-title {
            font-weight: 700;
            color: var(--text);
            margin-bottom: 5px;
        }

        .scenario-desc {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .w4-form {
            background-color: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .form-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 25px;
        }

        .form-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
        }

        .form-subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .step-section {
            margin-bottom: 30px;
        }

        .step-header {
            background-color: var(--surface);
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }

        .step-number {
            display: inline-block;
            width: 28px;
            height: 28px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            font-weight: 700;
            margin-right: 10px;
        }

        .step-title {
            font-weight: 600;
            color: var(--text);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: var(--surface);
            border-radius: 6px;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .results-panel {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 2px solid var(--success);
            border-radius: 8px;
            padding: 25px;
            margin-top: 30px;
        }

        .results-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 20px;
            text-align: center;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .result-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .result-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .result-detail {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        .info-box {
            background-color: #eff6ff;
            border-left: 4px solid var(--info);
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
        }

        .info-box h4 {
            color: var(--info);
            margin-bottom: 8px;
        }

        .info-box ul {
            margin-left: 20px;
            color: var(--text-light);
        }

        .info-box li {
            margin-bottom: 5px;
        }

        .actions {
            margin-top: 30px;
            text-align: center;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #4f46e5;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background-color: var(--surface);
        }

        /* Print Styles */
        @media print {
            body {
                background-color: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .scenario-selector,
            .actions {
                display: none;
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .scenario-selector {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.5rem;
            }

            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìã W-4 Withholding Simulator</h1>
            <p class="subtitle">Practice Completing W-4 Form & See Impact on Take-Home Pay</p>
            <div class="state-badge">üìç {{STATE_NAME}}</div>
        </header>

        <div class="main-content">
            <div class="scenario-selector">
                <div class="scenario-button active" onclick="loadScenario(1)">
                    <div class="scenario-title">Scenario 1</div>
                    <div class="scenario-desc">Single job, no dependents</div>
                </div>
                <div class="scenario-button" onclick="loadScenario(2)">
                    <div class="scenario-title">Scenario 2</div>
                    <div class="scenario-desc">Married, spouse works</div>
                </div>
                <div class="scenario-button" onclick="loadScenario(3)">
                    <div class="scenario-title">Scenario 3</div>
                    <div class="scenario-desc">Single with one child</div>
                </div>
            </div>

            <div class="w4-form">
                <div class="form-header">
                    <div class="form-title">Form W-4</div>
                    <div class="form-subtitle">Employee's Withholding Certificate (Simplified 2024 Version)</div>
                </div>

                <!-- Step 1: Enter Personal Information -->
                <div class="step-section">
                    <div class="step-header">
                        <span class="step-number">1</span>
                        <span class="step-title">Enter Personal Information</span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>First Name and Middle Initial</label>
                            <input type="text" id="firstName" placeholder="Enter first name">
                        </div>
                        <div class="form-group">
                            <label>Last Name</label>
                            <input type="text" id="lastName" placeholder="Enter last name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Social Security Number</label>
                            <input type="text" id="ssn" placeholder="XXX-XX-XXXX" maxlength="11">
                        </div>
                        <div class="form-group">
                            <label>Filing Status</label>
                            <select id="filingStatus" onchange="calculateWithholding()">
                                <option value="single">Single or Married filing separately</option>
                                <option value="married">Married filing jointly</option>
                                <option value="head">Head of household</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Multiple Jobs or Spouse Works -->
                <div class="step-section">
                    <div class="step-header">
                        <span class="step-number">2</span>
                        <span class="step-title">Multiple Jobs or Spouse Works</span>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="multipleJobs" onchange="calculateWithholding()">
                        <label for="multipleJobs">Complete this step if you (1) hold more than one job at a time, or (2) are married filing jointly and your spouse also works.</label>
                    </div>
                </div>

                <!-- Step 3: Claim Dependents -->
                <div class="step-section">
                    <div class="step-header">
                        <span class="step-number">3</span>
                        <span class="step-title">Claim Dependents</span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Number of qualifying children under age 17</label>
                            <input type="number" id="children" min="0" max="10" value="0" onchange="calculateWithholding()">
                        </div>
                        <div class="form-group">
                            <label>Number of other dependents</label>
                            <input type="number" id="otherDependents" min="0" max="10" value="0" onchange="calculateWithholding()">
                        </div>
                    </div>
                </div>

                <!-- Step 4: Other Adjustments -->
                <div class="step-section">
                    <div class="step-header">
                        <span class="step-number">4</span>
                        <span class="step-title">Other Adjustments (Optional)</span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Other income (not from jobs)</label>
                            <input type="number" id="otherIncome" min="0" value="0" onchange="calculateWithholding()">
                        </div>
                        <div class="form-group">
                            <label>Deductions (other than standard)</label>
                            <input type="number" id="deductions" min="0" value="0" onchange="calculateWithholding()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Extra withholding per pay period</label>
                        <input type="number" id="extraWithholding" min="0" value="0" onchange="calculateWithholding()">
                    </div>
                </div>

                <div class="form-group">
                    <label>Annual Salary (for calculation purposes)</label>
                    <input type="number" id="annualSalary" min="0" value="45000" onchange="calculateWithholding()">
                </div>

                <!-- Results Panel -->
                <div class="results-panel">
                    <div class="results-title">üí∞ Estimated Annual Tax Impact</div>
                    <div class="results-grid">
                        <div class="result-card">
                            <div class="result-label">Biweekly Take-Home</div>
                            <div class="result-value" id="biweeklyPay">$0</div>
                            <div class="result-detail">After all deductions</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Estimated Annual Tax</div>
                            <div class="result-value" id="annualTax">$0</div>
                            <div class="result-detail">Federal & State combined</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Refund/Balance Due</div>
                            <div class="result-value" id="refundAmount">$0</div>
                            <div class="result-detail" id="refundStatus">Estimated at year-end</div>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <h4>üìå {{STATE_NAME}} State Withholding Considerations</h4>
                    <ul>
                        <li>State income tax rate: <strong>{{STATE_INCOME_TAX_RATE}}%</strong></li>
                        <li>{{STATE_NAME}} uses a similar withholding system to federal W-4</li>
                        <li>Changes to your federal W-4 typically affect state withholding automatically</li>
                        <li>You may need to file a separate state withholding form in some cases</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h4>üîÑ When to Adjust Your W-4</h4>
                    <ul>
                        <li>You get married or divorced</li>
                        <li>You have a child or other dependent</li>
                        <li>You start or stop working a second job</li>
                        <li>Your spouse starts or stops working</li>
                        <li>You received a large refund or owed a lot last year</li>
                        <li>You buy a home or have other major life changes</li>
                    </ul>
                </div>
            </div>

            <div class="actions">
                <button class="btn-primary" onclick="window.print()">üñ®Ô∏è Print W-4</button>
                <button class="btn-secondary" onclick="resetForm()">üîÑ Reset Form</button>
            </div>
        </div>
    </div>

    <script>
        const STATE_INCOME_TAX_RATE = {{STATE_INCOME_TAX_RATE}} || 5.0;

        const scenarios = {
            1: {
                firstName: 'Jordan',
                lastName: 'Smith',
                ssn: '123-45-6789',
                filingStatus: 'single',
                multipleJobs: false,
                children: 0,
                otherDependents: 0,
                otherIncome: 0,
                deductions: 0,
                extraWithholding: 0,
                annualSalary: 38000
            },
            2: {
                firstName: 'Alex',
                lastName: 'Johnson',
                ssn: '987-65-4321',
                filingStatus: 'married',
                multipleJobs: true,
                children: 0,
                otherDependents: 0,
                otherIncome: 0,
                deductions: 0,
                extraWithholding: 0,
                annualSalary: 52000
            },
            3: {
                firstName: 'Taylor',
                lastName: 'Williams',
                ssn: '456-78-9123',
                filingStatus: 'head',
                multipleJobs: false,
                children: 1,
                otherDependents: 0,
                otherIncome: 0,
                deductions: 0,
                extraWithholding: 0,
                annualSalary: 42000
            }
        };

        function loadScenario(num) {
            // Update button states
            document.querySelectorAll('.scenario-button').forEach((btn, idx) => {
                btn.classList.toggle('active', idx + 1 === num);
            });

            const scenario = scenarios[num];
            document.getElementById('firstName').value = scenario.firstName;
            document.getElementById('lastName').value = scenario.lastName;
            document.getElementById('ssn').value = scenario.ssn;
            document.getElementById('filingStatus').value = scenario.filingStatus;
            document.getElementById('multipleJobs').checked = scenario.multipleJobs;
            document.getElementById('children').value = scenario.children;
            document.getElementById('otherDependents').value = scenario.otherDependents;
            document.getElementById('otherIncome').value = scenario.otherIncome;
            document.getElementById('deductions').value = scenario.deductions;
            document.getElementById('extraWithholding').value = scenario.extraWithholding;
            document.getElementById('annualSalary').value = scenario.annualSalary;

            calculateWithholding();
        }

        function calculateWithholding() {
            const annualSalary = parseFloat(document.getElementById('annualSalary').value) || 0;
            const filingStatus = document.getElementById('filingStatus').value;
            const multipleJobs = document.getElementById('multipleJobs').checked;
            const children = parseInt(document.getElementById('children').value) || 0;
            const otherDependents = parseInt(document.getElementById('otherDependents').value) || 0;
            const otherIncome = parseFloat(document.getElementById('otherIncome').value) || 0;
            const deductions = parseFloat(document.getElementById('deductions').value) || 0;
            const extraWithholding = parseFloat(document.getElementById('extraWithholding').value) || 0;

            // Standard deductions
            const standardDeductions = {
                single: 14600,
                married: 29200,
                head: 21900
            };

            // Calculate taxable income
            let taxableIncome = annualSalary + otherIncome;
            taxableIncome -= standardDeductions[filingStatus];
            taxableIncome -= deductions;
            taxableIncome = Math.max(0, taxableIncome);

            // Calculate federal tax (simplified)
            let federalTax = 0;
            if (filingStatus === 'single') {
                if (taxableIncome > 100525) federalTax = 14605.5 + (taxableIncome - 100525) * 0.24;
                else if (taxableIncome > 47150) federalTax = 5426 + (taxableIncome - 47150) * 0.22;
                else if (taxableIncome > 11600) federalTax = 1160 + (taxableIncome - 11600) * 0.12;
                else federalTax = taxableIncome * 0.10;
            } else if (filingStatus === 'married') {
                if (taxableIncome > 201050) federalTax = 29211 + (taxableIncome - 201050) * 0.24;
                else if (taxableIncome > 94300) federalTax = 10852 + (taxableIncome - 94300) * 0.22;
                else if (taxableIncome > 23200) federalTax = 2320 + (taxableIncome - 23200) * 0.12;
                else federalTax = taxableIncome * 0.10;
            } else { // head of household
                if (taxableIncome > 100500) federalTax = 14382 + (taxableIncome - 100500) * 0.24;
                else if (taxableIncome > 63100) federalTax = 6162 + (taxableIncome - 63100) * 0.22;
                else if (taxableIncome > 16550) federalTax = 1655 + (taxableIncome - 16550) * 0.12;
                else federalTax = taxableIncome * 0.10;
            }

            // Child tax credits
            const childCredit = children * 2000;
            const otherDependentCredit = otherDependents * 500;
            federalTax = Math.max(0, federalTax - childCredit - otherDependentCredit);

            // Multiple jobs adjustment (rough estimate)
            if (multipleJobs) {
                federalTax *= 1.15; // Increase withholding by 15%
            }

            // State tax
            const stateTax = annualSalary * (STATE_INCOME_TAX_RATE / 100);

            // FICA
            const socialSecurity = Math.min(annualSalary, 168600) * 0.062;
            const medicare = annualSalary * 0.0145;

            // Total annual tax
            const totalAnnualTax = federalTax + stateTax + socialSecurity + medicare;

            // Extra withholding
            const annualExtraWithholding = extraWithholding * 26; // Biweekly

            // Net pay
            const netAnnual = annualSalary - totalAnnualTax - annualExtraWithholding;
            const biweeklyNet = netAnnual / 26;

            // Refund estimate (simplified)
            const actualTax = federalTax + stateTax;
            const withheld = totalAnnualTax + annualExtraWithholding;
            const refund = withheld - actualTax;

            // Update display
            document.getElementById('biweeklyPay').textContent = formatCurrency(biweeklyNet);
            document.getElementById('annualTax').textContent = formatCurrency(totalAnnualTax);
            document.getElementById('refundAmount').textContent = formatCurrency(Math.abs(refund));

            const refundStatus = document.getElementById('refundStatus');
            if (refund > 0) {
                refundStatus.textContent = 'Estimated refund';
                refundStatus.style.color = 'var(--success)';
            } else if (refund < 0) {
                refundStatus.textContent = 'May owe at year-end';
                refundStatus.style.color = 'var(--danger)';
            } else {
                refundStatus.textContent = 'Approximately balanced';
                refundStatus.style.color = 'var(--text-light)';
            }
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function resetForm() {
            loadScenario(1);
        }

        // Initialize
        window.onload = function() {
            loadScenario(1);
        };
    </script>
</body>
</html>
