<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fraud Detection Simulator - PFL Academy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background: #f9fafb;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .intro-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .intro-section h3 {
            font-size: 18px;
            color: #6366f1;
            margin-bottom: 8px;
        }

        .intro-section p {
            color: #4b5563;
            font-size: 14px;
        }

        .progress-bar-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .progress-bar {
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #6366f1;
            border-radius: 6px;
            transition: width 0.3s ease;
        }

        .scenario-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .scenario-type {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .scenario-type.email { background: #dbeafe; color: #1d4ed8; }
        .scenario-type.phone { background: #fef3c7; color: #92400e; }
        .scenario-type.text { background: #d1fae5; color: #065f46; }
        .scenario-type.website { background: #ede9fe; color: #5b21b6; }

        .scenario-content {
            background: #f9fafb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .email-mock {
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            padding: 16px;
        }

        .email-header {
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 12px;
            margin-bottom: 12px;
        }

        .email-field {
            font-size: 12px;
            margin-bottom: 4px;
        }

        .email-field strong {
            color: #6b7280;
            display: inline-block;
            width: 50px;
        }

        .email-body {
            font-size: 13px;
            line-height: 1.7;
        }

        .phone-mock, .text-mock {
            background: #f3f4f6;
            border-radius: 12px;
            padding: 16px;
            max-width: 350px;
        }

        .phone-header {
            text-align: center;
            padding-bottom: 12px;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 12px;
        }

        .caller-id {
            font-weight: 600;
            font-size: 16px;
        }

        .call-transcript {
            font-size: 13px;
            font-style: italic;
            color: #4b5563;
        }

        .text-bubble {
            background: #e5e7eb;
            border-radius: 18px;
            padding: 10px 16px;
            margin-bottom: 8px;
            font-size: 13px;
            max-width: 280px;
        }

        .red-flags-selection {
            margin-bottom: 20px;
        }

        .red-flags-selection h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #374151;
        }

        .flag-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .flag-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .flag-option:hover {
            border-color: #6366f1;
        }

        .flag-option.selected {
            border-color: #6366f1;
            background: #eef2ff;
        }

        .flag-option.correct {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .flag-option.incorrect {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .flag-option input {
            display: none;
        }

        .flag-option label {
            font-size: 13px;
            cursor: pointer;
            flex: 1;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .action-btn {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-btn:hover {
            border-color: #6366f1;
        }

        .action-btn.selected {
            border-color: #6366f1;
            background: #eef2ff;
        }

        .submit-btn {
            background: #6366f1;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            margin-top: 16px;
        }

        .submit-btn:hover {
            background: #4f46e5;
        }

        .submit-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .feedback-section {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
            display: none;
        }

        .feedback-section.correct {
            background: #ecfdf5;
            border-left: 4px solid #10b981;
        }

        .feedback-section.incorrect {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
        }

        .feedback-section.partial {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
        }

        .feedback-section h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feedback-section.correct h4 { color: #065f46; }
        .feedback-section.incorrect h4 { color: #991b1b; }
        .feedback-section.partial h4 { color: #92400e; }

        .feedback-section p {
            font-size: 13px;
            color: #4b5563;
        }

        .results-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .results-section h3 {
            font-size: 18px;
            color: #6366f1;
            margin-bottom: 16px;
        }

        .final-score {
            text-align: center;
            padding: 24px;
            background: #f9fafb;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .score-circle.excellent { background: #d1fae5; }
        .score-circle.good { background: #dbeafe; }
        .score-circle.fair { background: #fef3c7; }
        .score-circle.needs-work { background: #fee2e2; }

        .score-value {
            font-size: 36px;
            font-weight: 700;
        }

        .score-circle.excellent .score-value { color: #065f46; }
        .score-circle.good .score-value { color: #1d4ed8; }
        .score-circle.fair .score-value { color: #92400e; }
        .score-circle.needs-work .score-value { color: #991b1b; }

        .score-label {
            font-size: 12px;
            color: #6b7280;
        }

        .performance-label {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .performance-description {
            font-size: 14px;
            color: #6b7280;
        }

        .reporting-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .reporting-section h3 {
            font-size: 18px;
            color: #6366f1;
            margin-bottom: 16px;
        }

        .reporting-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .reporting-card {
            background: #f9fafb;
            border-radius: 8px;
            padding: 16px;
        }

        .reporting-card h4 {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .reporting-card p {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .reporting-link {
            font-size: 12px;
            color: #6366f1;
            text-decoration: none;
            font-weight: 500;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .nav-btn {
            padding: 10px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }

        .nav-btn:hover {
            border-color: #6366f1;
        }

        .nav-btn.primary {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }

        .nav-btn.primary:hover {
            background: #4f46e5;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .print-section {
            text-align: center;
        }

        .print-btn {
            background: #6366f1;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
        }

        .print-btn:hover {
            background: #4f46e5;
        }

        @media print {
            body {
                padding: 10px;
                background: white;
            }

            .print-section,
            .nav-buttons {
                display: none;
            }

            .scenario-section,
            .results-section,
            .reporting-section {
                box-shadow: none;
                page-break-inside: avoid;
            }

            .reporting-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .flag-options,
            .reporting-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Fraud Detection Simulator</h1>
            <p>Test your ability to identify scams in emails, calls, texts, and websites</p>
        </div>

        <div class="intro-section">
            <h3>How This Works</h3>
            <p>You'll be presented with 5 different fraud scenarios. For each one, identify the red flags that indicate it's a scam and decide what action to take. Your fraud detection skills will be scored at the end.</p>
        </div>

        <div class="progress-bar-container">
            <div class="progress-info">
                <span>Scenario <span id="currentScenario">1</span> of 5</span>
                <span>Score: <span id="runningScore">0</span> points</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 20%"></div>
            </div>
        </div>

        <div class="scenario-section" id="scenarioContainer">
            <!-- Scenarios will be loaded here -->
        </div>

        <div class="results-section" id="resultsSection">
            <h3>Final Results</h3>
            <div class="final-score">
                <div class="score-circle" id="scoreCircle">
                    <div class="score-value" id="finalScore">0</div>
                    <div class="score-label">points</div>
                </div>
                <div class="performance-label" id="performanceLabel">Fraud Detection Level</div>
                <div class="performance-description" id="performanceDesc">Complete all scenarios to see your results.</div>
            </div>
        </div>

        <div class="reporting-section">
            <h3>Where to Report Fraud</h3>
            <p style="font-size: 13px; color: #6b7280; margin-bottom: 16px;">If you encounter real fraud, report it to these agencies:</p>

            <div class="reporting-grid">
                <div class="reporting-card">
                    <h4>Federal Trade Commission (FTC)</h4>
                    <p>Report all types of fraud, scams, and deceptive business practices</p>
                    <a href="https://reportfraud.ftc.gov" class="reporting-link" target="_blank">reportfraud.ftc.gov</a>
                </div>
                <div class="reporting-card">
                    <h4>FBI Internet Crime Complaint Center</h4>
                    <p>Report internet-related fraud and cybercrime</p>
                    <a href="https://www.ic3.gov" class="reporting-link" target="_blank">ic3.gov</a>
                </div>
                <div class="reporting-card">
                    <h4>State Attorney General</h4>
                    <p>Report scams targeting your state's residents</p>
                    <a href="https://www.naag.org/find-my-ag/" class="reporting-link" target="_blank">Find your state AG</a>
                </div>
                <div class="reporting-card">
                    <h4>Consumer Financial Protection Bureau</h4>
                    <p>Report financial product and service fraud</p>
                    <a href="https://www.consumerfinance.gov/complaint/" class="reporting-link" target="_blank">consumerfinance.gov</a>
                </div>
            </div>
        </div>

        <div class="print-section">
            <button class="print-btn" onclick="window.print()">Print / Save as PDF</button>
        </div>
    </div>

    <script>
        const scenarios = [
            {
                id: 1,
                type: 'email',
                title: 'Urgent Account Verification',
                content: `
                    <div class="email-mock">
                        <div class="email-header">
                            <div class="email-field"><strong>From:</strong> security@amaz0n-verify.com</div>
                            <div class="email-field"><strong>Subject:</strong> URGENT: Your account will be suspended in 24 hours!</div>
                        </div>
                        <div class="email-body">
                            <p>Dear Valued Customer,</p>
                            <p>We have detected unusual activity on your account. Your account will be permanantly suspended unless you verify your information immediatly.</p>
                            <p>Click here to verify: <span style="color: #6366f1; text-decoration: underline;">http://amaz0n-verify.com/secure-login</span></p>
                            <p>You must act within 24 hours or lose access to all your orders and saved payment methods.</p>
                            <p>Thank you,<br>Amazon Security Team</p>
                        </div>
                    </div>
                `,
                redFlags: [
                    { id: 'fake-domain', text: 'Suspicious domain (amaz0n-verify.com with zero)', correct: true },
                    { id: 'urgency', text: 'Creates false urgency (24 hours)', correct: true },
                    { id: 'spelling', text: 'Spelling errors (permanantly, immediatly)', correct: true },
                    { id: 'http-link', text: 'Non-HTTPS link in email', correct: true },
                    { id: 'generic', text: 'Generic greeting (Valued Customer)', correct: true },
                    { id: 'logo', text: 'Professional logo and formatting', correct: false }
                ],
                correctAction: 'delete',
                explanation: 'This is a classic phishing email. The domain uses a zero instead of "o", creates false urgency, contains spelling errors, and uses an insecure HTTP link. Never click links in suspicious emails - go directly to the official website instead.'
            },
            {
                id: 2,
                type: 'phone',
                title: 'IRS Phone Call',
                content: `
                    <div class="phone-mock">
                        <div class="phone-header">
                            <div class="caller-id">+1 (202) 555-0147</div>
                            <div style="font-size: 12px; color: #6b7280;">Incoming Call</div>
                        </div>
                        <div class="call-transcript">
                            <p>"This is Officer Johnson from the IRS Criminal Investigation Division. We have issued a warrant for your arrest due to unpaid taxes of $4,847. You must pay immediately using gift cards to avoid arrest. Police are on their way to your location. Stay on the line and do not hang up or you will be arrested. What stores are near you where you can purchase gift cards?"</p>
                        </div>
                    </div>
                `,
                redFlags: [
                    { id: 'gift-cards', text: 'Demands payment via gift cards', correct: true },
                    { id: 'arrest-threat', text: 'Threatens immediate arrest', correct: true },
                    { id: 'stay-line', text: 'Pressures you to stay on line', correct: true },
                    { id: 'no-verify', text: 'No way to verify caller identity', correct: true },
                    { id: 'specific-amount', text: 'Knows a specific amount you "owe"', correct: false },
                    { id: 'dc-number', text: 'Call from Washington DC area code', correct: false }
                ],
                correctAction: 'hang-up',
                explanation: 'The IRS NEVER demands immediate payment via gift cards, threatens arrest, or asks you to stay on the line. They always send written notice first. This is a common government impersonation scam. Hang up immediately.'
            },
            {
                id: 3,
                type: 'text',
                title: 'Prize Winner Text',
                content: `
                    <div class="text-mock">
                        <div class="text-bubble">
                            Congratulations! You've won a $1000 Walmart gift card! Claim now before it expires: bit.ly/claim-prize-now
                        </div>
                        <div class="text-bubble">
                            Reply YES to confirm and receive your prize code. Only 3 left!
                        </div>
                    </div>
                `,
                redFlags: [
                    { id: 'unsolicited', text: 'Unsolicited prize notification', correct: true },
                    { id: 'shortened-url', text: 'Shortened/disguised URL (bit.ly)', correct: true },
                    { id: 'scarcity', text: 'False scarcity (Only 3 left!)', correct: true },
                    { id: 'reply-confirm', text: 'Asks you to reply to confirm', correct: true },
                    { id: 'walmart-brand', text: 'Uses legitimate brand name (Walmart)', correct: false },
                    { id: 'specific-prize', text: 'Mentions specific prize amount', correct: false }
                ],
                correctAction: 'delete',
                explanation: 'You cannot win a contest you did not enter. Scammers use shortened URLs to hide malicious links and create false scarcity to pressure quick action. Never click links in unsolicited prize texts or reply to confirm anything.'
            },
            {
                id: 4,
                type: 'website',
                title: 'Online Shopping Site',
                content: `
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <strong style="font-size: 16px;">SuperDeals Electronics</strong>
                            <span style="background: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 4px; font-size: 11px;">http://</span>
                        </div>
                        <div style="font-size: 13px; margin-bottom: 12px;">
                            <p><strong>iPhone 15 Pro Max - $199</strong> <span style="text-decoration: line-through; color: #9ca3af;">$1,199</span></p>
                            <p style="color: #ef4444; font-weight: 600;">83% OFF - TODAY ONLY!</p>
                        </div>
                        <div style="font-size: 12px; color: #6b7280; margin-bottom: 12px;">
                            <p>Payment Methods: Wire Transfer, Zelle, Cash App</p>
                            <p>No returns. All sales final.</p>
                        </div>
                        <div style="font-size: 11px; color: #9ca3af;">
                            Contact: superdeals@gmail.com | No phone number listed
                        </div>
                    </div>
                `,
                redFlags: [
                    { id: 'no-https', text: 'Website uses HTTP (not secure)', correct: true },
                    { id: 'unrealistic-price', text: 'Unrealistically low price (83% off)', correct: true },
                    { id: 'wire-only', text: 'Only accepts wire transfer/payment apps', correct: true },
                    { id: 'no-returns', text: 'No returns policy', correct: true },
                    { id: 'no-phone', text: 'No phone number, only email', correct: true },
                    { id: 'gmail', text: 'Uses free email (Gmail) for business', correct: true }
                ],
                correctAction: 'avoid',
                explanation: 'This site shows every major red flag: no HTTPS security, prices too good to be true, only accepts untraceable payment methods, no returns policy, and unprofessional contact info. This is almost certainly a scam site.'
            },
            {
                id: 5,
                type: 'email',
                title: 'Job Opportunity Email',
                content: `
                    <div class="email-mock">
                        <div class="email-header">
                            <div class="email-field"><strong>From:</strong> hr.recruiting@company-jobs.net</div>
                            <div class="email-field"><strong>Subject:</strong> Work From Home - $5000/week - No Experience Needed!</div>
                        </div>
                        <div class="email-body">
                            <p>Hello,</p>
                            <p>We found your resume online and think you'd be perfect for our Customer Service Representative position!</p>
                            <p><strong>Job Details:</strong></p>
                            <ul style="margin-left: 20px; margin-bottom: 12px;">
                                <li>Salary: $5,000/week (paid daily via Zelle)</li>
                                <li>Hours: Flexible, work whenever you want</li>
                                <li>Equipment: We'll send you a check to buy supplies</li>
                            </ul>
                            <p>To get started, please send us your full name, address, date of birth, and bank account details for direct deposit setup.</p>
                            <p>Start earning tomorrow!</p>
                        </div>
                    </div>
                `,
                redFlags: [
                    { id: 'too-high-pay', text: 'Unrealistic pay ($5000/week, no experience)', correct: true },
                    { id: 'personal-info', text: 'Requests personal/banking information upfront', correct: true },
                    { id: 'check-scam', text: 'Will send check to buy supplies (fake check scam)', correct: true },
                    { id: 'zelle-pay', text: 'Payment via Zelle (untraceable)', correct: true },
                    { id: 'vague-job', text: 'Vague job description', correct: true },
                    { id: 'found-resume', text: 'Claims to have found your resume', correct: false }
                ],
                correctAction: 'delete',
                explanation: 'This combines multiple job scams: unrealistic pay, requesting banking info before hiring, and the classic fake check scam where they send you a check, have you buy supplies, then the check bounces. Legitimate employers never ask for banking details before hiring.'
            }
        ];

        let currentScenarioIndex = 0;
        let totalScore = 0;
        let scenarioScores = [];

        function loadScenario(index) {
            const scenario = scenarios[index];
            const container = document.getElementById('scenarioContainer');

            let flagOptionsHtml = scenario.redFlags.map(flag => `
                <div class="flag-option" onclick="toggleFlag(this, '${flag.id}')">
                    <input type="checkbox" id="${flag.id}" data-correct="${flag.correct}">
                    <label for="${flag.id}">${flag.text}</label>
                </div>
            `).join('');

            container.innerHTML = `
                <div class="scenario-header">
                    <h3>${scenario.title}</h3>
                    <span class="scenario-type ${scenario.type}">${scenario.type}</span>
                </div>

                <div class="scenario-content">
                    ${scenario.content}
                </div>

                <div class="red-flags-selection">
                    <h4>Identify the Red Flags (select all that apply):</h4>
                    <div class="flag-options">
                        ${flagOptionsHtml}
                    </div>
                </div>

                <div>
                    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: #374151;">What should you do?</h4>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="selectAction(this, 'respond')">Respond/Click Link</button>
                        <button class="action-btn" onclick="selectAction(this, 'verify')">Call to Verify</button>
                        <button class="action-btn" onclick="selectAction(this, '${scenario.type === 'phone' ? 'hang-up' : scenario.type === 'website' ? 'avoid' : 'delete'}')">
                            ${scenario.type === 'phone' ? 'Hang Up' : scenario.type === 'website' ? 'Avoid/Leave Site' : 'Delete/Ignore'}
                        </button>
                    </div>
                </div>

                <button class="submit-btn" onclick="submitAnswer()" id="submitBtn">Check My Answers</button>

                <div class="feedback-section" id="feedback"></div>

                <div class="nav-buttons">
                    <button class="nav-btn" onclick="previousScenario()" ${index === 0 ? 'disabled' : ''}>Previous</button>
                    <button class="nav-btn primary" onclick="nextScenario()" id="nextBtn" style="display: none;">
                        ${index === scenarios.length - 1 ? 'See Results' : 'Next Scenario'}
                    </button>
                </div>
            `;

            document.getElementById('currentScenario').textContent = index + 1;
            document.getElementById('progressFill').style.width = ((index + 1) / scenarios.length * 100) + '%';
        }

        function toggleFlag(element, flagId) {
            element.classList.toggle('selected');
            const checkbox = document.getElementById(flagId);
            checkbox.checked = !checkbox.checked;
        }

        let selectedAction = null;

        function selectAction(button, action) {
            document.querySelectorAll('.action-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            button.classList.add('selected');
            selectedAction = action;
        }

        function submitAnswer() {
            const scenario = scenarios[currentScenarioIndex];
            let flagScore = 0;
            let maxFlagScore = 0;
            let correctFlags = 0;
            let incorrectFlags = 0;

            // Score red flag selections
            document.querySelectorAll('.flag-option').forEach(option => {
                const checkbox = option.querySelector('input');
                const isCorrect = checkbox.dataset.correct === 'true';
                const isSelected = checkbox.checked;

                if (isCorrect) {
                    maxFlagScore += 10;
                    if (isSelected) {
                        flagScore += 10;
                        correctFlags++;
                        option.classList.add('correct');
                    }
                } else if (isSelected) {
                    flagScore -= 5;
                    incorrectFlags++;
                    option.classList.add('incorrect');
                }
            });

            // Score action selection
            let actionScore = 0;
            if (selectedAction === scenario.correctAction) {
                actionScore = 20;
            } else if (selectedAction === 'verify' && scenario.correctAction !== 'respond') {
                actionScore = 10; // Partial credit for being cautious
            }

            const scenarioScore = Math.max(0, flagScore + actionScore);
            totalScore += scenarioScore;
            scenarioScores.push(scenarioScore);

            // Update running score
            document.getElementById('runningScore').textContent = totalScore;

            // Show feedback
            const feedback = document.getElementById('feedback');
            let feedbackClass = 'correct';
            let feedbackTitle = 'Excellent!';

            if (scenarioScore < maxFlagScore / 2) {
                feedbackClass = 'incorrect';
                feedbackTitle = 'Needs Improvement';
            } else if (scenarioScore < maxFlagScore) {
                feedbackClass = 'partial';
                feedbackTitle = 'Good Effort';
            }

            feedback.className = `feedback-section ${feedbackClass}`;
            feedback.innerHTML = `
                <h4>${feedbackTitle} - ${scenarioScore} points</h4>
                <p><strong>Explanation:</strong> ${scenario.explanation}</p>
                <p style="margin-top: 8px;"><strong>Your red flag detection:</strong> ${correctFlags} correct, ${incorrectFlags} incorrect</p>
            `;
            feedback.style.display = 'block';

            // Disable submit, show next
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('nextBtn').style.display = 'inline-block';
        }

        function nextScenario() {
            if (currentScenarioIndex < scenarios.length - 1) {
                currentScenarioIndex++;
                selectedAction = null;
                loadScenario(currentScenarioIndex);
            } else {
                showResults();
            }
        }

        function previousScenario() {
            if (currentScenarioIndex > 0) {
                currentScenarioIndex--;
                selectedAction = null;
                loadScenario(currentScenarioIndex);
            }
        }

        function showResults() {
            document.getElementById('scenarioContainer').style.display = 'none';
            document.querySelector('.progress-bar-container').style.display = 'none';

            const resultsSection = document.getElementById('resultsSection');
            resultsSection.style.display = 'block';

            const maxPossible = scenarios.length * 70; // Approximate max per scenario
            const percentage = Math.round((totalScore / maxPossible) * 100);

            document.getElementById('finalScore').textContent = totalScore;

            const scoreCircle = document.getElementById('scoreCircle');
            const perfLabel = document.getElementById('performanceLabel');
            const perfDesc = document.getElementById('performanceDesc');

            scoreCircle.classList.remove('excellent', 'good', 'fair', 'needs-work');

            if (percentage >= 80) {
                scoreCircle.classList.add('excellent');
                perfLabel.textContent = 'Fraud Detection Expert';
                perfDesc.textContent = 'Excellent work! You can identify most fraud attempts and know how to respond safely. Keep staying vigilant!';
            } else if (percentage >= 60) {
                scoreCircle.classList.add('good');
                perfLabel.textContent = 'Fraud Aware';
                perfDesc.textContent = 'Good job! You recognize many fraud red flags. Review the scenarios you missed to strengthen your skills.';
            } else if (percentage >= 40) {
                scoreCircle.classList.add('fair');
                perfLabel.textContent = 'Learning to Detect';
                perfDesc.textContent = 'You\'re developing fraud detection skills. Study common scam tactics and practice identifying red flags.';
            } else {
                scoreCircle.classList.add('needs-work');
                perfLabel.textContent = 'Needs Practice';
                perfDesc.textContent = 'Take time to learn about common fraud tactics. Review each scenario\'s explanation and practice identifying red flags.';
            }
        }

        // Initialize first scenario
        loadScenario(0);
    </script>
</body>
</html>
