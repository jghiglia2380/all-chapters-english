<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L-46: Automobile Finance - Buying vs. Leasing | PFL Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Core component styles */
        .learning-objectives {
            background-color: #e6f3ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .discussion-prompt {
            background-color: #e6f0ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #3b82f6;
        }

        .case-study {
            background-color: #f0f9ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0ea5e9;
        }

        .skill-builder {
            background-color: #f3e8ff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .key-concept {
            background-color: #fef3c7;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 0.75rem 0;
            border-left: 4px solid #f59e0b;
        }

        /* Activity timer */
        .activity-timer {
            background-color: #FFFBEB;
            border-left: 4px solid #F59E0B;
            padding: 0.75rem 1rem;
            margin: 1rem 0;
            font-weight: 500;
        }

        /* State variable highlight */
        .state-variable {
            background-color: #dbeafe;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Fixed Header - Purple with Navigation -->
    <header class="bg-indigo-600 text-white p-4 shadow-md fixed top-0 left-0 right-0 z-40">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">PFL Academy</h1>
            <nav class="hidden md:block">
                <ul class="flex space-x-6">
                    <li><a href="#" class="text-white hover:text-indigo-200">Home</a></li>
                    <li><a href="#" class="text-white hover:text-indigo-200">Curriculum</a></li>
                    <li><a href="#" class="text-white hover:text-indigo-200">Resources</a></li>
                    <li><a href="#" class="text-white hover:text-indigo-200">Profile</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Spacer to push content below fixed header -->
    <div class="h-16"></div>

    <div class="container mx-auto px-4 py-8 grid lg:grid-cols-10 gap-8">
        <!-- Left Navigation Sidebar -->
        <div class="lg:col-span-3 bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Financial Decisions</h2>
            <p class="text-gray-600 mb-6">Making informed choices about major purchases and financing</p>

            <!-- Chapter Navigation -->
            <nav class="space-y-2" aria-label="Chapters">
                <!-- Current chapter with blue left border -->
                <a href="#" class="w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg bg-indigo-50 text-indigo-700 border-l-4 border-indigo-700">
                    <span class="mr-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                    </span>
                    <span class="text-left">L-46 Automobile Finance</span>
                </a>

                <!-- Section navigation -->
                <div class="ml-6 space-y-1 mt-1">
                    <a href="#intro" class="text-indigo-700 font-medium flex items-center">
                        <span class="mr-2">‚Ä¢</span> Introduction
                    </a>
                    <a href="#key-concepts" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Key Concepts
                    </a>
                    <a href="#buying" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Understanding Buying
                    </a>
                    <a href="#leasing" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Understanding Leasing
                    </a>
                    <a href="#comparing" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Comparing TCO
                    </a>
                    <a href="#implications" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Financial Implications
                    </a>
                    <a href="#examples" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Real-World Examples
                    </a>
                    <a href="#reflection" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Reflection
                    </a>
                    <a href="#skill-builder" class="text-gray-700 hover:text-indigo-700 flex items-center">
                        <span class="mr-2">‚Ä¢</span> Skill Builder
                    </a>
                </div>
            </nav>

            <div class="mt-8 bg-gradient-to-r from-indigo-100 to-indigo-200 rounded-lg p-4">
                <h3 class="text-lg font-semibold text-indigo-800 mb-2">Your Progress</h3>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
                    <div class="bg-indigo-600 h-2.5 rounded-full" style="width: 0%" id="progressBar"></div>
                </div>
                <p class="text-sm text-indigo-800">Completed: <span class="font-medium" id="progressText">0/9 sections</span></p>
            </div>

            <div class="mt-8">
                <a href="day2.html" class="block text-center bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                    Preview Day 2 Learning Lab ‚Üí
                </a>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="lg:col-span-7 bg-white rounded-lg shadow p-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">L-46: Automobile Finance - Buying vs. Leasing</h1>

            <!-- Learning Objectives -->
            <div class="learning-objectives" id="intro">
                <h2 class="text-xl font-semibold text-gray-900 mb-3">Learning Objectives</h2>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>Analyze the financial differences between buying and leasing a vehicle</li>
                    <li>Calculate the total cost of ownership for different financing scenarios</li>
                    <li>Evaluate how vehicle financing decisions impact overall financial health</li>
                    <li>Compare loan terms, interest rates, and their effects on total vehicle costs</li>
                    <li>Make informed decisions about vehicle acquisition aligned with personal financial goals</li>
                </ul>
            </div>

            <!-- Introduction -->
            <section class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Introduction</h2>
                <p class="text-gray-700 mb-4">
                    For most Americans, purchasing or leasing a vehicle represents one of the largest financial decisions they'll make, second only to housing. The average new car costs over $48,000, and the financing method you choose can result in thousands of dollars in difference over the life of your ownership. Whether you're buying your first car or upgrading to a newer model, understanding the financial implications of buying versus leasing is crucial to making a decision that supports your long-term financial goals.
                </p>
                <p class="text-gray-700 mb-4">
                    Many young adults approach vehicle acquisition with excitement but little understanding of the complete financial picture. The advertised monthly payment is only one piece of a complex puzzle that includes interest rates, loan terms, insurance costs, maintenance, depreciation, and opportunity costs. A decision that seems affordable month-to-month can become a significant financial burden when viewed holistically.
                </p>
                <p class="text-gray-700">
                    The choice between buying and leasing isn't simply about which option costs less‚Äîit's about which option aligns best with your financial situation, driving needs, and long-term goals. Some situations favor buying, while others make leasing more advantageous. Understanding the complete financial landscape empowers you to make informed decisions that serve your broader financial wellbeing rather than simply minimizing your monthly payment.
                </p>
            </section>

            <!-- Key Concepts -->
            <section class="mb-8" id="key-concepts">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Key Concepts</h2>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Auto Loan</h3>
                    <p class="text-gray-700 text-sm">A secured loan where the vehicle serves as collateral, allowing you to purchase a car by making monthly payments over a set period, typically 36-72 months</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Lease</h3>
                    <p class="text-gray-700 text-sm">A contract that allows you to use a vehicle for a specified period (usually 24-36 months) by making monthly payments, after which you return the vehicle or have the option to purchase it</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Depreciation</h3>
                    <p class="text-gray-700 text-sm">The decrease in a vehicle's value over time due to age, mileage, and wear; new cars typically lose 20-30% of their value in the first year</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Total Cost of Ownership (TCO)</h3>
                    <p class="text-gray-700 text-sm">The complete financial cost of owning or leasing a vehicle, including purchase price, financing costs, insurance, fuel, maintenance, repairs, and depreciation</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Capitalized Cost</h3>
                    <p class="text-gray-700 text-sm">In leasing, the negotiated price of the vehicle that determines your lease payments; similar to the purchase price when buying</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Residual Value</h3>
                    <p class="text-gray-700 text-sm">The estimated value of a leased vehicle at the end of the lease term, which affects monthly payment calculations</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Money Factor</h3>
                    <p class="text-gray-700 text-sm">The interest rate in a lease agreement, expressed as a decimal rather than a percentage; multiply by 2,400 to convert to APR</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Gap Insurance</h3>
                    <p class="text-gray-700 text-sm">Coverage that pays the difference between what you owe on a vehicle and its actual cash value if the car is totaled or stolen</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Equity</h3>
                    <p class="text-gray-700 text-sm">The difference between what your vehicle is worth and what you owe on it; positive equity means you own more than you owe</p>
                </div>

                <div class="key-concept">
                    <h3 class="font-semibold text-gray-900">Opportunity Cost</h3>
                    <p class="text-gray-700 text-sm">The potential financial gain you could have achieved by investing money elsewhere instead of putting it toward a vehicle</p>
                </div>
            </section>

            <!-- Deeper Exploration -->
            <section class="mb-8" id="buying">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Understanding Vehicle Buying</h2>
                <p class="text-gray-700 mb-4">
                    When you buy a vehicle, whether with cash or a loan, you are purchasing an asset that you own outright (or will own once the loan is paid off). Auto loans are secured loans, meaning the vehicle itself serves as collateral‚Äîif you fail to make payments, the lender can repossess the vehicle. Most auto loans range from 36 to 72 months, though longer terms of up to 84 months have become increasingly common.
                </p>
                <p class="text-gray-700 mb-4">
                    The financial dynamics of buying involve several key considerations. First, you'll typically make a down payment of 10-20% of the vehicle's purchase price, though this varies. Your monthly payment is determined by the loan amount, interest rate, and loan term. Lower interest rates and shorter loan terms result in lower total interest paid, but higher monthly payments. Conversely, longer loan terms reduce monthly payments but substantially increase the total interest paid over the life of the loan.
                </p>
                <p class="text-gray-700">
                    One of the most significant aspects of vehicle ownership is depreciation. New cars lose approximately 20-30% of their value in the first year, and about 60% by the fifth year. This means a $40,000 vehicle could be worth only $16,000 after five years, representing a $24,000 loss in value. However, once you own the vehicle outright, you can continue driving it without monthly payments, potentially for many years, which can make buying financially advantageous in the long run.
                </p>
            </section>

            <section class="mb-8" id="leasing">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Understanding Vehicle Leasing</h2>
                <p class="text-gray-700 mb-4">
                    Leasing a vehicle is fundamentally different from buying‚Äîyou're essentially renting the vehicle for a set period, typically 24-36 months. Your monthly lease payments cover the vehicle's depreciation during the lease term, plus interest (expressed as a "money factor") and fees. At the end of the lease, you return the vehicle unless you choose to purchase it for the predetermined residual value.
                </p>
                <p class="text-gray-700 mb-4">
                    Leases typically require a smaller upfront payment than buying, sometimes called a "cap cost reduction," though zero-down leases are also available. Monthly lease payments are generally lower than loan payments for the same vehicle because you're only paying for a portion of the vehicle's value‚Äîthe depreciation during your lease term‚Äîrather than the entire purchase price.
                </p>
                <p class="text-gray-700">
                    However, leases come with significant restrictions. Most leases limit you to 10,000-15,000 miles per year, with substantial penalties (typically $0.15-$0.30 per mile) for exceeding these limits. You're also responsible for maintaining the vehicle in excellent condition; excessive wear and tear will result in additional charges when you return it. Furthermore, you cannot modify the vehicle, and you're essentially locked into the lease term‚Äîearly termination can be extremely expensive.
                </p>
            </section>

            <section class="mb-8" id="comparing">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Comparing Total Cost of Ownership</h2>
                <p class="text-gray-700 mb-4">
                    The true financial comparison between buying and leasing requires examining the total cost of ownership over your expected period of vehicle use. For buying, this includes the purchase price, financing costs, insurance, fuel, maintenance, repairs, and the vehicle's residual value when you eventually sell or trade it. For leasing, it includes all lease payments, any acquisition fees, disposition fees, potential mileage overages, excess wear charges, and the fact that you have no asset at the end of the lease term.
                </p>
                <p class="text-gray-700 mb-4">
                    Consider a $35,000 vehicle over six years. If you buy with a 5% loan over 60 months, you'll pay approximately $41,166 total (including interest), but you'll own an asset worth roughly $14,000, making your net cost $27,166. If you lease the same vehicle twice (two 3-year leases) at $400/month, you'll pay $28,800 in lease payments, plus potential fees and overages, and you'll have no asset at the end‚Äîa net cost of $30,000 or more.
                </p>
                <p class="text-gray-700">
                    However, this simplified comparison doesn't account for several factors that might favor leasing for some individuals: leases typically include warranty coverage for the entire lease term, potentially reducing maintenance costs; leasing allows you to drive a newer vehicle with the latest safety features and technology; and for business owners, lease payments may offer tax advantages.
                </p>

                <!-- Interactive Loan Amortization Calculator -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 mt-6 border-2 border-blue-200">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">üéØ Loan Amortization Calculator</h3>
                    <p class="text-gray-700 mb-4">Adjust the sliders to see how interest rate and loan term impact your total cost:</p>

                    <div class="grid md:grid-cols-3 gap-4 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Loan Amount: $<span id="loanAmountValue">30000</span></label>
                            <input type="range" id="loanAmount" min="15000" max="50000" step="1000" value="30000"
                                   oninput="updateLoanChart()"
                                   class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>$15K</span>
                                <span>$50K</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Interest Rate: <span id="interestRateValue">5.0</span>%</label>
                            <input type="range" id="interestRate" min="2" max="12" step="0.5" value="5"
                                   oninput="updateLoanChart()"
                                   class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>2%</span>
                                <span>12%</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Loan Term: <span id="loanTermValue">60</span> months</label>
                            <input type="range" id="loanTerm" min="24" max="84" step="6" value="60"
                                   oninput="updateLoanChart()"
                                   class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>24mo</span>
                                <span>84mo</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded p-4 mb-4">
                        <canvas id="loanAmortizationChart" style="max-height: 300px;"></canvas>
                    </div>

                    <div class="grid md:grid-cols-3 gap-4 bg-white rounded p-4">
                        <div class="text-center">
                            <p class="text-sm text-gray-600">Monthly Payment</p>
                            <p class="text-2xl font-bold text-indigo-600">$<span id="monthlyPayment">566</span></p>
                        </div>
                        <div class="text-center">
                            <p class="text-sm text-gray-600">Total Interest Paid</p>
                            <p class="text-2xl font-bold text-red-600">$<span id="totalInterest">3,968</span></p>
                        </div>
                        <div class="text-center">
                            <p class="text-sm text-gray-600">Total Amount Paid</p>
                            <p class="text-2xl font-bold text-gray-900">$<span id="totalPaid">33,968</span></p>
                        </div>
                    </div>

                    <div class="mt-4 p-4 bg-yellow-50 rounded border-l-4 border-yellow-400">
                        <p class="text-sm text-gray-700"><strong>üí° Key Insight:</strong> Even a 2% difference in interest rate can add thousands to your total cost. Shop around for the best rate before committing!</p>
                    </div>
                </div>

                <!-- Interactive TCO Visualization -->
                <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 mt-6 border-2 border-indigo-200">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">üìä Interactive Cost Comparison: Buy vs. Lease</h3>
                    <p class="text-gray-700 mb-4">Select a timeframe to see how total costs compare between buying and leasing the same $35,000 vehicle:</p>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Choose Your Timeframe:</label>
                        <select id="timeframeSelect" onchange="updateCostChart()" class="w-full border border-gray-300 rounded px-3 py-2 bg-white">
                            <option value="3years">3 Years (One Lease Term)</option>
                            <option value="5years" selected>5 Years (Typical Loan Term)</option>
                            <option value="7years">7 Years (Extended Ownership)</option>
                        </select>
                    </div>

                    <div class="mb-6 bg-white rounded p-4">
                        <canvas id="costComparisonChart" style="max-height: 350px;"></canvas>
                    </div>

                    <div id="costDetails" class="space-y-3">
                        <!-- Details will be populated by JavaScript -->
                    </div>

                    <div class="mt-4 p-4 bg-yellow-50 rounded border-l-4 border-yellow-400">
                        <p class="text-sm text-gray-700"><strong>üí° Key Insight:</strong> The longer you keep a vehicle after paying it off, the more advantageous buying becomes compared to perpetual leasing. Notice how the gap widens over time as ownership eliminates monthly payments while leasing continues them indefinitely.</p>
                    </div>
                </div>
            </section>

            <section class="mb-8" id="implications">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Implications & Importance</h2>
                <p class="text-gray-700 mb-4">
                    Vehicle financing decisions have far-reaching implications for your overall financial health. A car payment that consumes 15-20% or more of your take-home pay can severely limit your ability to save for emergencies, invest for retirement, or achieve other financial goals. The average American spends over $700 per month on vehicle costs including payments, insurance, fuel, and maintenance‚Äîthat's $8,400 per year, or potentially $100,000 over a decade.
                </p>
                <p class="text-gray-700 mb-4">
                    The decision to buy or lease also affects your financial flexibility. Owning a vehicle outright provides an asset you can sell if needed and eliminates monthly payments once the loan is paid off. Leasing keeps you in a perpetual payment cycle but provides flexibility to change vehicles every few years without the hassle of selling. For young adults, understanding these tradeoffs is crucial to making decisions aligned with career changes, relocations, or changing family needs.
                </p>
                <p class="text-gray-700 mb-4">
                    Moreover, the interest rate you secure on an auto loan is often influenced by your credit score, making this an important arena where your credit history directly impacts your finances. A borrower with excellent credit might secure a 3% interest rate, while someone with poor credit could face rates of 10% or higher‚Äîon a $30,000 loan, this difference amounts to thousands of dollars over the life of the loan.
                </p>
                <p class="text-gray-700">
                    The opportunity cost of vehicle spending is perhaps the most overlooked factor. Money spent on a new car depreciates immediately and generates no investment return. If instead of making a $500 monthly car payment, you drove a reliable used car (paid off) and invested that $500 monthly for 30 years at a 7% average return, you would accumulate approximately $600,000. Understanding these trade-offs helps contextualize vehicle decisions within your broader financial picture.
                </p>
            </section>

            <!-- Real-World Examples -->
            <section class="mb-8" id="examples">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Real-World Examples</h2>

                <div class="case-study mb-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-3">üìä Mia's Buy-and-Keep Strategy</h3>
                    <p class="text-gray-700 mb-3">
                        Mia graduated college and needed a reliable vehicle for her new job. She considered leasing a new SUV for $450/month but instead purchased a certified pre-owned sedan for $18,000 with a $3,000 down payment. She financed $15,000 at 4.5% over 48 months, resulting in payments of $342/month.
                    </p>
                    <p class="text-gray-700 mb-3">
                        After four years, Mia owned her vehicle outright and it was worth approximately $10,000. For the next three years, she drove the same car payment-free while saving $342/month. Over seven years, Mia spent $19,416 in payments (plus her $3,000 down payment) but owned an asset worth $10,000, for a net cost of $12,416‚Äîand she still had a reliable vehicle.
                    </p>
                    <p class="text-gray-700 font-semibold">
                        Result: Her monthly savings of $342 for three years totaled $12,312 in saved payments, which she invested in her retirement account. By choosing to buy and keep a vehicle long-term, Mia both minimized her transportation costs and accelerated her wealth-building.
                    </p>
                </div>

                <div class="case-study mb-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-3">üìä James's Perpetual Lease Cycle</h3>
                    <p class="text-gray-700 mb-3">
                        James loved having the newest vehicle with the latest technology and safety features. He leased a new truck for $499/month with $2,000 down on a 36-month lease. When that lease ended, he leased another new truck for $525/month with another $2,000 down.
                    </p>
                    <p class="text-gray-700 mb-3">
                        Over six years, James paid $36,864 in lease payments plus $4,000 in down payments, totaling $40,864, with no asset at the end. Additionally, he was charged $1,200 in excess mileage fees and $800 in excess wear charges over the two leases.
                    </p>
                    <p class="text-gray-700 font-semibold">
                        Result: His total cost was $42,864 with nothing to show for it. While James enjoyed always driving a new vehicle under warranty, his perpetual lease cycle prevented him from ever having a period without monthly payments and left him with no built equity or ownership‚Äîa pattern that, if continued, could cost him hundreds of thousands over his lifetime while providing no lasting asset.
                    </p>
                </div>

                <div class="case-study">
                    <h3 class="text-xl font-semibold text-gray-900 mb-3">üìä Taylor's Strategic Balance</h3>
                    <p class="text-gray-700 mb-3">
                        Taylor evaluated both buying and leasing before deciding. She determined she needed a reliable vehicle for at least eight years but also valued having modern safety features. She bought a new, fuel-efficient sedan for $28,000 with $5,000 down, financing $23,000 at 3.8% over 60 months with a monthly payment of $423.
                    </p>
                    <p class="text-gray-700 mb-3">
                        After five years, she owned her car outright (worth about $11,000) and had paid approximately $30,380 total. She then drove the car payment-free for three more years while saving her previous $423/month payment. Over eight years, her net cost was approximately $19,380 (accounting for the car's value), and she'd saved $15,228 by not having payments for three years.
                    </p>
                    <p class="text-gray-700 font-semibold">
                        Result: Taylor then traded in her vehicle for $7,000 and bought another reliable used car, continuing her pattern of ownership rather than leasing. This strategy gave her the benefits of a new car with modern features while ultimately minimizing long-term costs through ownership.
                    </p>
                </div>
            </section>

            <!-- Reflection -->
            <div class="discussion-prompt" id="reflection">
                <h3 class="text-xl font-semibold text-gray-900 mb-3">üí≠ Reflection Prompt</h3>
                <p class="text-gray-700">
                    Consider your anticipated vehicle needs over the next 5-10 years. Given your financial situation, career stage, and lifestyle, which financing approach (buying new, buying used, or leasing) might best align with your goals? How might your decision affect your ability to achieve other financial priorities like building an emergency fund, saving for a home, or investing for retirement? What factors beyond the monthly payment should influence your decision?
                </p>
            </div>

            <!-- Skill Builder -->
            <div class="skill-builder" id="skill-builder">
                <div class="activity-timer mb-4">
                    ‚è±Ô∏è Activity Time: 20 minutes
                </div>

                <h2 class="text-2xl font-bold text-gray-900 mb-4">üöó Auto Finance Decision Calculator</h2>
                <p class="text-gray-700 mb-6">
                    Use this interactive calculator to compare the complete financial picture of buying versus leasing a vehicle. Input real numbers to see how different financing decisions affect your total cost over 6 years.
                </p>

                <!-- Scenario Selection -->
                <div class="mb-6 bg-white p-4 rounded-lg border-2 border-indigo-200">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">Choose Your Scenario</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <button onclick="selectScenario('buy-new')" id="btn-buy-new" class="p-4 border-2 border-gray-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition">
                            <div class="text-2xl mb-2">üÜï</div>
                            <div class="font-semibold">Buy New</div>
                            <div class="text-sm text-gray-600">Own outright, highest cost</div>
                        </button>
                        <button onclick="selectScenario('buy-used')" id="btn-buy-used" class="p-4 border-2 border-gray-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition">
                            <div class="text-2xl mb-2">üöô</div>
                            <div class="font-semibold">Buy Used</div>
                            <div class="text-sm text-gray-600">Best value, own asset</div>
                        </button>
                        <button onclick="selectScenario('lease')" id="btn-lease" class="p-4 border-2 border-gray-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition">
                            <div class="text-2xl mb-2">üìù</div>
                            <div class="font-semibold">Lease</div>
                            <div class="text-sm text-gray-600">Lower payment, no ownership</div>
                        </button>
                    </div>
                </div>

                <!-- Buy New Form -->
                <div id="form-buy-new" class="scenario-form hidden">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Buy New Vehicle Scenario</h3>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Purchase Price</label>
                            <input type="number" id="new-price" value="30000" class="w-full p-2 border border-gray-300 rounded" placeholder="30000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Down Payment (%)</label>
                            <input type="number" id="new-down" value="20" class="w-full p-2 border border-gray-300 rounded" placeholder="20">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Loan Term (months)</label>
                            <select id="new-term" class="w-full p-2 border border-gray-300 rounded">
                                <option value="36">36 months</option>
                                <option value="48">48 months</option>
                                <option value="60" selected>60 months</option>
                                <option value="72">72 months</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Interest Rate (%)</label>
                            <input type="number" step="0.1" id="new-rate" value="5.8" class="w-full p-2 border border-gray-300 rounded" placeholder="5.8">
                            <p class="text-xs text-gray-500 mt-1">State avg: <span class="state-variable">5.8%</span></p>
                        </div>
                    </div>
                    <button onclick="calculateBuyNew()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                        Calculate Total Cost
                    </button>
                </div>

                <!-- Buy Used Form -->
                <div id="form-buy-used" class="scenario-form hidden">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Buy Used Vehicle Scenario</h3>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Purchase Price</label>
                            <input type="number" id="used-price" value="20000" class="w-full p-2 border border-gray-300 rounded" placeholder="20000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Down Payment (%)</label>
                            <input type="number" id="used-down" value="15" class="w-full p-2 border border-gray-300 rounded" placeholder="15">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Loan Term (months)</label>
                            <select id="used-term" class="w-full p-2 border border-gray-300 rounded">
                                <option value="36">36 months</option>
                                <option value="48" selected>48 months</option>
                                <option value="60">60 months</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Interest Rate (%)</label>
                            <input type="number" step="0.1" id="used-rate" value="7.2" class="w-full p-2 border border-gray-300 rounded" placeholder="7.2">
                            <p class="text-xs text-gray-500 mt-1">State avg: <span class="state-variable">7.2%</span></p>
                        </div>
                    </div>
                    <button onclick="calculateBuyUsed()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                        Calculate Total Cost
                    </button>
                </div>

                <!-- Lease Form -->
                <div id="form-lease" class="scenario-form hidden">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Lease Vehicle Scenario</h3>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Monthly Lease Payment</label>
                            <input type="number" id="lease-payment" value="400" class="w-full p-2 border border-gray-300 rounded" placeholder="400">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Down Payment</label>
                            <input type="number" id="lease-down" value="2000" class="w-full p-2 border border-gray-300 rounded" placeholder="2000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Lease Term (months)</label>
                            <select id="lease-term" class="w-full p-2 border border-gray-300 rounded">
                                <option value="24">24 months</option>
                                <option value="36" selected>36 months</option>
                                <option value="48">48 months</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Acquisition Fee</label>
                            <input type="number" id="lease-acq" value="695" class="w-full p-2 border border-gray-300 rounded" placeholder="695">
                            <p class="text-xs text-gray-500 mt-1">Typical: <span class="state-variable">$695</span></p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Annual Miles</label>
                            <input type="number" id="lease-miles" value="12000" class="w-full p-2 border border-gray-300 rounded" placeholder="12000">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Excess Mile Penalty ($/mile)</label>
                            <input type="number" step="0.01" id="lease-penalty" value="0.25" class="w-full p-2 border border-gray-300 rounded" placeholder="0.25">
                        </div>
                    </div>
                    <button onclick="calculateLease()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                        Calculate Total Cost
                    </button>
                </div>

                <!-- Results -->
                <div id="results" class="hidden mt-6 p-6 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border-2 border-indigo-200">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">üìä 6-Year Cost Analysis</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-white p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">Monthly Payment</div>
                            <div class="text-2xl font-bold text-indigo-600" id="result-monthly">$0</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">Total Paid (6 years)</div>
                            <div class="text-2xl font-bold text-gray-900" id="result-total">$0</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">Estimated Vehicle Value</div>
                            <div class="text-2xl font-bold text-green-600" id="result-value">$0</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <div class="text-sm text-gray-600 mb-1">Net Cost</div>
                            <div class="text-2xl font-bold text-red-600" id="result-net">$0</div>
                        </div>
                    </div>
                    <div class="mt-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                        <p class="text-sm font-semibold text-yellow-800" id="result-insight">Calculate a scenario to see insights!</p>
                    </div>
                    <button onclick="saveCalculation()" class="mt-4 w-full bg-green-600 text-white py-2 rounded-lg font-semibold hover:bg-green-700 transition">
                        üíæ Save This Calculation
                    </button>
                </div>

                <!-- Saved Calculations -->
                <div id="saved-calcs" class="hidden mt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">Your Saved Comparisons</h3>
                    <div id="saved-list" class="space-y-2"></div>
                </div>
            </div>

            <!-- Summary -->
            <section class="mb-8 bg-gray-50 p-6 rounded-lg">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Summary</h2>
                <p class="text-gray-700 mb-4">
                    Vehicle acquisition represents a significant financial decision that extends far beyond the advertised monthly payment. The choice between buying and leasing involves careful consideration of total cost of ownership, including depreciation, financing costs, insurance, maintenance, and opportunity costs.
                </p>
                <p class="text-gray-700 mb-4">
                    Buying typically results in lower long-term costs and builds equity, particularly if you keep the vehicle beyond the loan payoff period. Leasing offers lower monthly payments and the flexibility of regularly updated vehicles but results in perpetual payments with no asset accumulation.
                </p>
                <p class="text-gray-700">
                    The most financially sound approach often involves purchasing a reliable vehicle‚Äîwhether new or used‚Äîkeeping it well-maintained, and continuing to drive it after the loan is paid off. The years of payment-free driving can substantially reduce lifetime vehicle costs and free up resources for other financial goals.
                </p>
            </section>
        </div>
    </div>

    <script>
        let currentScenario = null;
        let savedCalculations = JSON.parse(localStorage.getItem('l46-calculations')) || [];

        // Scenario selection
        function selectScenario(scenario) {
            currentScenario = scenario;

            // Reset button styles
            document.querySelectorAll('[id^="btn-"]').forEach(btn => {
                btn.classList.remove('border-indigo-600', 'bg-indigo-100');
                btn.classList.add('border-gray-300');
            });

            // Highlight selected
            document.getElementById(`btn-${scenario}`).classList.add('border-indigo-600', 'bg-indigo-100');
            document.getElementById(`btn-${scenario}`).classList.remove('border-gray-300');

            // Hide all forms
            document.querySelectorAll('.scenario-form').forEach(form => form.classList.add('hidden'));

            // Show selected form
            document.getElementById(`form-${scenario}`).classList.remove('hidden');

            // Hide results
            document.getElementById('results').classList.add('hidden');
        }

        // Calculate Buy New
        function calculateBuyNew() {
            const price = parseFloat(document.getElementById('new-price').value);
            const downPct = parseFloat(document.getElementById('new-down').value) / 100;
            const term = parseInt(document.getElementById('new-term').value);
            const rate = parseFloat(document.getElementById('new-rate').value) / 100 / 12;

            const downPayment = price * downPct;
            const loanAmount = price - downPayment;
            const monthly = (loanAmount * rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            const totalPaid = (monthly * term) + downPayment;

            // Estimate value after 6 years (72 months)
            const yearsOwned = Math.min(6, term / 12);
            const depreciation = 0.20 * (yearsOwned / 1) + 0.10 * Math.max(0, (yearsOwned - 1)); // 20% year 1, 10% per year after
            const estimatedValue = price * (1 - Math.min(depreciation, 0.65)); // Cap at 65% depreciation

            const netCost = totalPaid - estimatedValue;

            showResults(monthly, totalPaid, estimatedValue, netCost, 'Buy New', {
                price, downPayment, term, rate: rate * 12 * 100
            });
        }

        // Calculate Buy Used
        function calculateBuyUsed() {
            const price = parseFloat(document.getElementById('used-price').value);
            const downPct = parseFloat(document.getElementById('used-down').value) / 100;
            const term = parseInt(document.getElementById('used-term').value);
            const rate = parseFloat(document.getElementById('used-rate').value) / 100 / 12;

            const downPayment = price * downPct;
            const loanAmount = price - downPayment;
            const monthly = (loanAmount * rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            const totalPaid = (monthly * term) + downPayment;

            // Used car already depreciated, slower depreciation
            const yearsOwned = Math.min(6, term / 12);
            const depreciation = 0.08 * yearsOwned; // 8% per year for used
            const estimatedValue = price * (1 - Math.min(depreciation, 0.50)); // Cap at 50% depreciation

            const netCost = totalPaid - estimatedValue;

            showResults(monthly, totalPaid, estimatedValue, netCost, 'Buy Used', {
                price, downPayment, term, rate: rate * 12 * 100
            });
        }

        // Calculate Lease
        function calculateLease() {
            const monthly = parseFloat(document.getElementById('lease-payment').value);
            const downPayment = parseFloat(document.getElementById('lease-down').value);
            const term = parseInt(document.getElementById('lease-term').value);
            const acqFee = parseFloat(document.getElementById('lease-acq').value);
            const annualMiles = parseFloat(document.getElementById('lease-miles').value);
            const excessPenalty = parseFloat(document.getElementById('lease-penalty').value);

            // Assume 2 leases over 6 years
            const numLeases = Math.ceil(72 / term);
            const totalPaid = (monthly * term * numLeases) + (downPayment * numLeases) + (acqFee * numLeases);

            // Add potential mileage overages (assume 10% over on average)
            const allowedMiles = (annualMiles * (term / 12));
            const excessMiles = allowedMiles * 0.1; // 10% overage
            const mileageFees = excessMiles * excessPenalty * numLeases;

            const totalWithFees = totalPaid + mileageFees + (400 * numLeases); // Disposition fees
            const estimatedValue = 0; // No ownership
            const netCost = totalWithFees;

            showResults(monthly, totalWithFees, estimatedValue, netCost, 'Lease', {
                monthly, term, numLeases, mileageFees
            });
        }

        // Show results
        function showResults(monthly, total, value, net, scenario, details) {
            document.getElementById('result-monthly').textContent = '$' + monthly.toFixed(0);
            document.getElementById('result-total').textContent = '$' + total.toFixed(0);
            document.getElementById('result-value').textContent = '$' + value.toFixed(0);
            document.getElementById('result-net').textContent = '$' + net.toFixed(0);

            // Generate insight
            let insight = '';
            if (scenario === 'Buy New') {
                const paymentFreeYears = Math.max(0, 6 - (details.term / 12));
                insight = `After paying off the loan in ${details.term} months, you'll have ${(paymentFreeYears * 12).toFixed(0)} payment-free months and still own an asset worth $${value.toFixed(0)}!`;
            } else if (scenario === 'Buy Used') {
                const paymentFreeYears = Math.max(0, 6 - (details.term / 12));
                insight = `Best value! Lower purchase price AND ${(paymentFreeYears * 12).toFixed(0)} payment-free months. Net cost is $${(net / 72).toFixed(0)}/month over 6 years.`;
            } else {
                insight = `‚ö†Ô∏è You'll make ${details.numLeases} lease payments totaling $${total.toFixed(0)} with NO asset at the end. That's $${(net / 72).toFixed(0)}/month with nothing to show.`;
            }

            document.getElementById('result-insight').textContent = insight;
            document.getElementById('results').classList.remove('hidden');

            // Store for saving
            window.lastCalculation = { scenario, monthly, total, value, net, details };
        }

        // Save calculation
        function saveCalculation() {
            if (window.lastCalculation) {
                savedCalculations.push({
                    ...window.lastCalculation,
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem('l46-calculations', JSON.stringify(savedCalculations));
                displaySavedCalculations();
                alert('‚úÖ Calculation saved! You can compare different scenarios.');
            }
        }

        // Display saved calculations
        function displaySavedCalculations() {
            const savedList = document.getElementById('saved-list');
            const savedSection = document.getElementById('saved-calcs');

            if (savedCalculations.length === 0) {
                savedSection.classList.add('hidden');
                return;
            }

            savedSection.classList.remove('hidden');
            savedList.innerHTML = savedCalculations.map((calc, idx) => `
                <div class="bg-white p-3 rounded-lg border border-gray-200 flex justify-between items-center">
                    <div>
                        <span class="font-semibold">${calc.scenario}</span>
                        <span class="text-sm text-gray-600 ml-3">Monthly: $${calc.monthly.toFixed(0)}</span>
                        <span class="text-sm text-gray-600 ml-3">Net: $${calc.net.toFixed(0)}</span>
                    </div>
                    <button onclick="deleteSaved(${idx})" class="text-red-600 hover:text-red-800">üóëÔ∏è</button>
                </div>
            `).join('');
        }

        // Delete saved calculation
        function deleteSaved(idx) {
            savedCalculations.splice(idx, 1);
            localStorage.setItem('l46-calculations', JSON.stringify(savedCalculations));
            displaySavedCalculations();
        }

        // Track section progress
        const sections = ['intro', 'key-concepts', 'buying', 'leasing', 'comparing', 'implications', 'examples', 'reflection', 'skill-builder'];
        const viewedSections = new Set();

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.target.id) {
                    viewedSections.add(entry.target.id);
                    updateProgress();
                }
            });
        }, { threshold: 0.5 });

        sections.forEach(id => {
            const el = document.getElementById(id);
            if (el) observer.observe(el);
        });

        function updateProgress() {
            const progress = (viewedSections.size / sections.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${viewedSections.size}/${sections.length} sections`;
        }

        // Load saved calculations on page load
        displaySavedCalculations();

        // Chart.js Interactive Cost Comparison
        let costChart = null;

        const costData = {
            '3years': {
                buyTotal: 23100,  // $35k vehicle, $5k down, $30k @ 5% for 60mo = $566/mo √ó 36 = $20,376 + $5k down = $25,376, minus $17,500 value = $7,876 net
                leaseTotal: 16400, // $400/mo √ó 36 + $2k down = $16,400
                buyAssetValue: 17500,
                leaseAssetValue: 0,
                buyDescription: '$5,000 down + $566/mo √ó 36 months = $25,376 spent. Vehicle worth $17,500. Net cost: $7,876.',
                leaseDescription: '$2,000 down + $400/mo √ó 36 months = $16,400 spent. No asset remaining. Net cost: $16,400.',
                winner: 'Buying costs less long-term, but leasing has lower monthly payments and less upfront cost in this short timeframe.'
            },
            '5years': {
                buyTotal: 38966,
                leaseTotal: 26000,
                buyAssetValue: 14000,
                leaseAssetValue: 0,
                buyDescription: '$5,000 down + $566/mo √ó 60 months = $38,960 spent. Vehicle worth $14,000. Net cost: $24,960.',
                leaseDescription: 'Two 30-month leases: $2,000 down each + $400/mo √ó 60 months = $28,000 spent. No asset. Net cost: $28,000.',
                winner: 'Buying saves $3,040 over 5 years and you own an asset worth $14,000.'
            },
            '7years': {
                buyTotal: 38966,
                leaseTotal: 38800,
                buyAssetValue: 10500,
                leaseAssetValue: 0,
                buyDescription: '$5,000 down + $566/mo √ó 60 months = $38,960 total spent. Then 24 months payment-free. Vehicle worth $10,500. Net cost: $28,460.',
                leaseDescription: 'Three leases: $6,000 down total + $400/mo √ó 84 months = $39,600 spent. No asset. Net cost: $39,600.',
                winner: 'Buying saves $11,140 over 7 years! Two payment-free years make a huge difference.'
            }
        };

        function updateCostChart() {
            const selected = document.getElementById('timeframeSelect').value;
            const data = costData[selected];

            if (costChart) {
                costChart.destroy();
            }

            const ctx = document.getElementById('costComparisonChart').getContext('2d');
            costChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Buying (with loan)', 'Leasing (continuous)'],
                    datasets: [
                        {
                            label: 'Total Cost Paid',
                            data: [data.buyTotal - data.buyAssetValue, data.leaseTotal],
                            backgroundColor: ['#4F46E5', '#EF4444'],
                            borderWidth: 2,
                            borderColor: ['#312E81', '#991B1B']
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'Net Cost: $' + context.parsed.y.toLocaleString();
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Net Cost Comparison (' + selected.replace('years', ' Years') + ')',
                            font: { size: 16, weight: 'bold' }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            },
                            title: {
                                display: true,
                                text: 'Total Net Cost'
                            }
                        }
                    }
                }
            });

            // Update details
            const detailsDiv = document.getElementById('costDetails');
            detailsDiv.innerHTML = `
                <div class="bg-indigo-50 p-4 rounded border-l-4 border-indigo-600">
                    <h4 class="font-bold text-indigo-900 mb-2">üöó Buying Option</h4>
                    <p class="text-sm text-gray-700">${data.buyDescription}</p>
                </div>
                <div class="bg-red-50 p-4 rounded border-l-4 border-red-600">
                    <h4 class="font-bold text-red-900 mb-2">üìù Leasing Option</h4>
                    <p class="text-sm text-gray-700">${data.leaseDescription}</p>
                </div>
                <div class="bg-green-50 p-4 rounded border-l-4 border-green-600">
                    <h4 class="font-bold text-green-900 mb-2">‚úÖ The Verdict</h4>
                    <p class="text-sm text-gray-700">${data.winner}</p>
                </div>
            `;
        }

        // Loan Amortization Calculator
        let loanChart = null;

        function updateLoanChart() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value);
            const loanTerm = parseInt(document.getElementById('loanTerm').value);

            // Update display values
            document.getElementById('loanAmountValue').textContent = loanAmount.toLocaleString();
            document.getElementById('interestRateValue').textContent = interestRate.toFixed(1);
            document.getElementById('loanTermValue').textContent = loanTerm;

            // Calculate monthly payment
            const monthlyRate = interestRate / 100 / 12;
            const monthlyPayment = (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, loanTerm)) /
                                   (Math.pow(1 + monthlyRate, loanTerm) - 1);

            // Calculate total amounts
            const totalPaid = monthlyPayment * loanTerm;
            const totalInterest = totalPaid - loanAmount;

            // Update summary numbers
            document.getElementById('monthlyPayment').textContent = monthlyPayment.toFixed(0).toLocaleString();
            document.getElementById('totalInterest').textContent = totalInterest.toFixed(0).toLocaleString();
            document.getElementById('totalPaid').textContent = totalPaid.toFixed(0).toLocaleString();

            // Calculate amortization data for chart
            let balance = loanAmount;
            const labels = [];
            const principalData = [];
            const interestData = [];

            // Show data points for every year
            for (let month = 1; month <= loanTerm; month++) {
                const interestPayment = balance * monthlyRate;
                const principalPayment = monthlyPayment - interestPayment;
                balance -= principalPayment;

                // Record yearly data points
                if (month % 12 === 0 || month === loanTerm) {
                    const year = Math.ceil(month / 12);
                    labels.push(`Year ${year}`);
                    principalData.push(principalPayment * 12);
                    interestData.push(interestPayment * 12);
                }
            }

            // Update chart
            if (loanChart) {
                loanChart.destroy();
            }

            const ctx = document.getElementById('loanAmortizationChart').getContext('2d');
            loanChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Principal',
                            data: principalData,
                            backgroundColor: '#4F46E5',
                            borderWidth: 0
                        },
                        {
                            label: 'Interest',
                            data: interestData,
                            backgroundColor: '#EF4444',
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.parsed.y.toFixed(0).toLocaleString();
                                }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Annual Payment Breakdown: Principal vs Interest',
                            font: { size: 14, weight: 'bold' }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            },
                            title: {
                                display: true,
                                text: 'Annual Payment Amount'
                            }
                        }
                    }
                }
            });
        }

        // Initialize the charts on page load
        window.addEventListener('DOMContentLoaded', function() {
            updateCostChart();
            updateLoanChart();
        });
    </script>
</body>
</html>
